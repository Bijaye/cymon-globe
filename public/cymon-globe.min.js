/*! cymon-globe 23-03-2015 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=React.createClass({seriesItemStyle:{listStyleType:"none",margin:"0 0 -1px 0",padding:3,border:"1px solid #555",border:"1px solid rgba( 85, 85, 85, 0.5 )",minWidth:150},seriesToggleLinkStyle:{color:"#fff",textDecoration:"none",display:"inline-block",width:"100%",position:"relative",zIndex:10,WebkitTransition:"color 500ms ease-out",MozTransition:"color 500ms ease-out",OTransition:"color 500ms ease-out",transition:"color 500ms ease-out"},progressBarStyle:{width:"66%",height:20,display:"inline-block",position:"absolute",left:3,maxWidth:150,backgroundColor:"#008EAF",backgroundColor:"rgba( 0, 142, 175, 0.5 )",WebkitTransition:"width 500ms linear",MozTransition:"width 500ms linear",OTransition:"width 500ms linear",transition:"width 500ms linear"},getInitialState:function(){return{active:!0}},handleLinkClick:function(){return this.setState({active:!this.state.active})},render:function(){var a;return a=0,this.state.active?(this.seriesToggleLinkStyle.color="#fff",this.progressBarStyle.width=this.props.percentage+"%",a=this.props.percentage):(this.seriesToggleLinkStyle.color="#555",this.progressBarStyle.width="0"),React.createElement("li",{style:this.seriesItemStyle,className:"series"},React.createElement("a",{style:this.seriesToggleLinkStyle,onClick:this.handleLinkClick,href:"#"},"Sample series"),React.createElement("div",{style:this.progressBarStyle,"aria-value-now":a,"aria-value-min":"0","aria-value-max":"100"}))}})},{}],2:[function(a,b){var c;c=a("./series-item"),b.exports=React.createClass({headerStyle:{fontSize:18},seriesListStyle:{margin:0,padding:0},render:function(){return React.createElement("div",null,React.createElement("h2",{style:this.headerStyle},"Threat Types"),React.createElement("ul",{style:this.seriesListStyle},React.createElement(c,{percentage:"10"}),React.createElement(c,{percentage:"66"}),React.createElement(c,{percentage:"42"}),React.createElement(c,{percentage:"75"}),React.createElement(c,{percentage:"50"})))}})},{"./series-item":1}],3:[function(a,b){var c,d,e,f,g,h,i,j,k,l=function(a,b){return function(){return a.apply(b,arguments)}};g=a("./components/series-selector"),c=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]],j=0,b.exports={createGlobe:function(a,b){return new d(a,b)}},e=Math.PI/2,f=.003,h={earth:{uniforms:{texture:{type:"t",value:null}},vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec3 vNormal;","varying vec2 vUv;","void main() {","vec3 diffuse = texture2D( texture, vUv ).xyz;","float intensity = 1.05 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) );","vec3 atmosphere = vec3( 1.0, 1.0, 1.0 ) * pow( intensity, 3.0 );","gl_FragColor = vec4( diffuse + atmosphere, 1.0 );","}"].join("\n")},atmosphere:{uniforms:{},vertexShader:["varying vec3 vNormal;","void main() {","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","void main() {","float intensity = pow( 0.8 - dot( vNormal, vec3( 0, 0, 1.0 ) ), 12.0 );","gl_FragColor = vec4( 0.5, 0.5, 0.5, 0.25 ) * intensity;","}"].join("\n")}},d=function(){function a(a,b){var c,d,e,g,i,j;this.container=a,this.backgroundTexture=b,this.onMouseWheel=l(this.onMouseWheel,this),this.onMouseOut=l(this.onMouseOut,this),this.onMouseUp=l(this.onMouseUp,this),this.onMouseMove=l(this.onMouseMove,this),this.onMouseDown=l(this.onMouseDown,this),this.mouse={x:0,y:0},this.mouseOnDown={x:0,y:0},this.inMouseDrag=!1,this.overRenderer=!1,this.rotation={x:0,y:0},this.target={x:1.7*Math.PI,y:Math.PI/5},this.targetOnDown={x:0,y:0},this.distance=1e5,this.distanceTarget=1e5,this.k=f,this.f=!1,j=this.container.offsetWidth||window.innerWidth,d=this.container.offsetHeight||window.innerHeight,this.camera=new THREE.PerspectiveCamera(26,j/d,1,1e4),this.camera.position.z=this.distance,this.scene=new THREE.Scene,c=new THREE.SphereGeometry(150,40,30),g=h.earth,i=THREE.UniformsUtils.clone(g.uniforms),i.texture.value=this.backgroundTexture,e=new THREE.ShaderMaterial({uniforms:i,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader}),this.mesh=new THREE.Mesh(c,e),this.mesh.rotation.y=Math.PI,this.scene.add(this.mesh),g=h.atmosphere,i=THREE.UniformsUtils.clone(g.uniforms),e=new THREE.ShaderMaterial({uniforms:i,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),this.mesh=new THREE.Mesh(c,e),this.mesh.scale.set(1.1,1.1,1.1),this.scene.add(this.mesh),c=new THREE.BoxGeometry(.75,.75,1),c.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,-.5)),this.point=new THREE.Mesh(c),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(j,d),this.renderer.domElement.style.position="absolute",this.container.appendChild(this.renderer.domElement),this.container.addEventListener("mousemove",this.onMouseMove,!1),this.container.addEventListener("mouseup",this.onMouseUp,!1),this.container.addEventListener("mouseout",this.onMouseOut,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1),this.container.addEventListener("mousewheel",this.onMouseWheel,!1),this.container.addEventListener("DOMMouseScroll",function(a){return function(b){var c;return c=window.event||b,a.onMouseWheel(c)}}(this),!1),this.container.addEventListener("mouseover",function(a){return function(){return a.overRenderer=!0}}(this),!1),this.container.addEventListener("mouseout",function(a){return function(){return a.overRenderer=!1}}(this),!1)}return a.prototype.addData=function(a){var b,c,d,e,f,g,h,j,l,m,n,o,p;for(k(a),c=function(a,b){return i(a[b+2])},p=new THREE.Geometry,e=0,h=a.length;h>e;e++)for(o=a[e],n=o[1],d=f=0,j=n.length;j>f;d=f+=3)m=n[d],g=o[1][d],l=o[1][d+1],b=c(o[1],d),this.addPoint(g,l,0,b,p);this._baseGeometry=p},a.prototype.createPoints=function(){return null!=this._baseGeometry?(this.points=new THREE.Mesh(this._baseGeometry,new THREE.MeshBasicMaterial({color:16777215,vertexColors:THREE.FaceColors,morphTargets:!1})),this.scene.add(this.points)):void 0},a.prototype.addPoint=function(a,b,c,d,e){var f,g,h,i,j,k;for(i=(90-a)*Math.PI/180,k=(180-b)*Math.PI/180,this.point.position.x=150*Math.sin(i)*Math.cos(k),this.point.position.y=150*Math.cos(i),this.point.position.z=150*Math.sin(i)*Math.sin(k),this.point.lookAt(this.mesh.position),this.point.scale.z=Math.max(c,.1),this.point.updateMatrix(),j=this.point.geometry.faces,g=0,h=j.length;h>g;g++)f=j[g],f.color=d;return e.mergeMesh(this.point)},a.prototype.initLegend=function(){return React.render(React.createElement(g,{series:{}}),document.getElementById("series-selector"))},a.prototype.onMouseDown=function(a){return a.preventDefault(),this.k=0,this.f=!0,this.inMouseDrag=!0,this.target.y=this.rotation.y,this.mouseOnDown.x=-a.clientX,this.mouseOnDown.y=a.clientY,this.targetOnDown.x=this.target.x,this.targetOnDown.y=this.target.y,this.container.style.cursor="move"},a.prototype.onMouseMove=function(a){var b;if(this.inMouseDrag)return this.mouse.x=-a.clientX,this.mouse.y=a.clientY,b=this.distance/1e3,this.target.x=this.targetOnDown.x+.005*(this.mouse.x-this.mouseOnDown.x)*b,this.target.y=this.targetOnDown.y+.005*(this.mouse.y-this.mouseOnDown.y)*b,this.target.y=this.target.y>e?e:this.target.y,this.target.y=this.target.y<-e?-e:this.target.y},a.prototype.onMouseUp=function(){return this.inMouseDrag?(this.k=f,this.f=!1,this.inMouseDrag=!1,this.container.style.cursor="auto"):void 0},a.prototype.onMouseOut=function(){return this.inMouseDrag?(this.k=f,this.f=!1,this.inMouseDrag=!1):void 0},a.prototype.onMouseWheel=function(a){var b;return a.preventDefault(),this.overRenderer&&(b=0,a.wheelDelta?b=.3*a.wheelDelta:a.detail&&(b=10*-a.detail),this.zoom(b)),!1},a.prototype.zoom=function(a){return this.distanceTarget-=a,this.distanceTarget=this.distanceTarget>1100?1100:this.distanceTarget,this.distanceTarget=this.distanceTarget<350?350:this.distanceTarget},a.prototype.render=function(){return this.zoom(0),this.target.x-=this.k,this.rotation.x+=.2*(this.target.x-this.rotation.x),this.f?this.rotation.y+=.2*(this.target.y-this.rotation.y):(this.target.y=Math.PI/5,this.rotation.y+=.02*(this.target.y-this.rotation.y)),this.distance+=.3*(this.distanceTarget-this.distance),this.camera.position.x=this.distance*Math.sin(this.rotation.x)*Math.cos(this.rotation.y),this.camera.position.y=this.distance*Math.sin(this.rotation.y),this.camera.position.z=this.distance*Math.cos(this.rotation.x)*Math.cos(this.rotation.y),this.camera.lookAt(this.mesh.position),this.renderer.render(this.scene,this.camera)},a}(),i=function(a){var b,d,e,f,g,h;return a/=j,d=0,0>=a?(f=0,g=0):a>=1?(f=c.length-1,g=c.length-1):(a*=c.length-1,f=Math.floor(a),g=f+1,d=a-f),h=(c[g][0]-c[f][0])*d+c[f][0],e=(c[g][1]-c[f][1])*d+c[f][1],b=(c[g][2]-c[f][2])*d+c[f][2],new THREE.Color(255*h,255*e,255*b)},k=function(a){var b,c,d,e;for(d=[],b=0,c=a.length;c>b;b++)e=a[b],d.push(Math.max.apply(Math,e[1]));return j=Math.max.apply(Math,d)}},{"./components/series-selector":2}],4:[function(a){var b,c,d;b=a("./globe"),d=null,$(function(){return Detector.webgl?$.ajax({url:"http://cymon.io/api/publicajax/nexus/globe/?categories=1",dataType:"json",error:function(a,b){return alert("Could not load data. Reason: "+b)},success:function(a){var e;return e=document.getElementById("globe"),THREE.ImageUtils.loadTexture("../img/map2.jpg",void 0,function(f){return d=b.createGlobe(e,f),d.addData(a.data),d.createPoints(),d.initLegend(),c()})}}):Detector.addGetWebGLMessage()}),c=function(){return requestAnimationFrame(c),d.render()}},{"./globe":3}]},{},[1,2,3,4]);