/*! cymon-globe 24-03-2015 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c;c=a("../utils"),b.exports=React.createClass({seriesItemStyle:{listStyleType:"none",margin:"0 0 -1px 0",padding:3,border:"1px solid #555",border:"1px solid rgba( 85, 85, 85, 0.5 )",minWidth:150},seriesToggleLinkStyle:{color:"#fff",textDecoration:"none",display:"inline-block",width:"100%",position:"relative",zIndex:10,textTransform:"capitalize",cursor:"pointer",WebkitTransition:"color 500ms ease-out",MozTransition:"color 500ms ease-out",OTransition:"color 500ms ease-out",transition:"color 500ms ease-out"},progressBarStyle:{width:"66%",height:20,display:"inline-block",position:"absolute",left:3,maxWidth:150,WebkitTransition:"width 500ms linear",MozTransition:"width 500ms linear",OTransition:"width 500ms linear",transition:"width 500ms linear"},render:function(){var a,b;return a=0,b=c.colourMap(this.props.percentage,100),this.progressBarStyle.backgroundColor="rgba( "+b.r+", "+b.g+", "+b.b+", 0.5 )",this.props.active?(this.seriesToggleLinkStyle.color="#fff",this.progressBarStyle.width=this.props.percentage+"%",a=this.props.percentage):(this.seriesToggleLinkStyle.color="#555",this.progressBarStyle.width="0"),React.createElement("li",{style:this.seriesItemStyle,className:"series"},React.createElement("span",{style:this.seriesToggleLinkStyle,onClick:this.props.toggleHandler,role:"checkbox","aria-checked":this.props.active},this.props.name),React.createElement("div",{style:this.progressBarStyle,"aria-value-now":a,"aria-value-min":"0","aria-value-max":"100"}))}})},{"../utils":5}],2:[function(a,b){var c;c=a("./series-item"),b.exports=React.createClass({headerStyle:{fontSize:18},seriesListStyle:{margin:0,padding:0},getInitialState:function(){return{}},componentWillMount:function(){var a,b,c,d,e;for(a={},e=this.props.series,c=0,d=e.length;d>c;c++)b=e[c],a[b.name]=!0;return this.setState(a)},handleSeriesItemToggle:function(a){var b;return b={},b[a]=!this.state[a],this.setState(b),this.props.toggleHandler(a,b[a])},render:function(){var a,b,d,e,f;for(a=this.props.totalHits,f=this.props.series,d=0,e=f.length;e>d;d++)b=f[d],this.state[b.name]||(a-=b.numHits);return React.createElement("div",null,React.createElement("h2",{style:this.headerStyle},"Threat Types"),React.createElement("ul",{style:this.seriesListStyle},this.props.series.map(function(b){return function(d){var e;return e={name:d.name,percentage:Math.floor(d.numHits/a*100),active:b.state[d.name],toggleHandler:b.handleSeriesItemToggle.bind(b,d.name)},React.createElement(c,React.__spread({},e))}}(this))))}})},{"./series-item":1}],3:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}};h=a("tween.js"),f=a("./components/series-selector"),l=a("./utils"),j="",i={},b.exports={createGlobe:function(a,b){return new c(a,b)}},d=Math.PI/2,e=.003,g={earth:{uniforms:{texture:{type:"t",value:null}},vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec3 vNormal;","varying vec2 vUv;","void main() {","vec3 diffuse = texture2D( texture, vUv ).xyz;","float intensity = 1.05 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) );","vec3 atmosphere = vec3( 1.0, 1.0, 1.0 ) * pow( intensity, 3.0 );","gl_FragColor = vec4( diffuse + atmosphere, 1.0 );","}"].join("\n")},atmosphere:{uniforms:{},vertexShader:["varying vec3 vNormal;","void main() {","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","void main() {","float intensity = pow( 0.8 - dot( vNormal, vec3( 0, 0, 1.0 ) ), 12.0 );","gl_FragColor = vec4( 0.5, 0.5, 0.5, 0.25 ) * intensity;","}"].join("\n")}},c=function(){function a(a,b){var c,d,f,h,i,j;this.container=a,this.backgroundTexture=b,this.onLegendToggle=m(this.onLegendToggle,this),this.onMouseWheel=m(this.onMouseWheel,this),this.onMouseOut=m(this.onMouseOut,this),this.onMouseUp=m(this.onMouseUp,this),this.onMouseMove=m(this.onMouseMove,this),this.onMouseDown=m(this.onMouseDown,this),this.mouse={x:0,y:0},this.mouseOnDown={x:0,y:0},this.inMouseDrag=!1,this.overRenderer=!1,this.rotation={x:0,y:0},this.target={x:1.7*Math.PI,y:Math.PI/5},this.targetOnDown={x:0,y:0},this.seriesGeos={},this._legendState=[],this._totalHits=0,this.distance=1e5,this.distanceTarget=1e5,this.k=e,this.f=!1,j=this.container.offsetWidth||window.innerWidth,d=this.container.offsetHeight||window.innerHeight,this.camera=new THREE.PerspectiveCamera(26,j/d,1,1e4),this.camera.position.z=this.distance,this.scene=new THREE.Scene,c=new THREE.SphereGeometry(150,40,30),h=g.earth,i=THREE.UniformsUtils.clone(h.uniforms),i.texture.value=this.backgroundTexture,f=new THREE.ShaderMaterial({uniforms:i,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}),this.mesh=new THREE.Mesh(c,f),this.mesh.rotation.y=Math.PI,this.scene.add(this.mesh),h=g.atmosphere,i=THREE.UniformsUtils.clone(h.uniforms),f=new THREE.ShaderMaterial({uniforms:i,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),this.mesh=new THREE.Mesh(c,f),this.mesh.scale.set(1.1,1.1,1.1),this.scene.add(this.mesh),c=new THREE.BoxGeometry(.75,.75,1),c.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,-.5)),this.point=new THREE.Mesh(c),this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(j,d),this.renderer.domElement.style.position="absolute",this.container.appendChild(this.renderer.domElement),this.container.addEventListener("mousemove",this.onMouseMove,!1),this.container.addEventListener("mouseup",this.onMouseUp,!1),this.container.addEventListener("mouseout",this.onMouseOut,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1),this.container.addEventListener("mousewheel",this.onMouseWheel,!1),this.container.addEventListener("DOMMouseScroll",function(a){return function(b){var c;return c=window.event||b,a.onMouseWheel(c)}}(this),!1),this.container.addEventListener("mouseover",function(a){return function(){return a.overRenderer=!0}}(this),!1),this.container.addEventListener("mouseout",function(a){return function(){return a.overRenderer=!1}}(this),!1)}return a.prototype.addData=function(a){var b,c,d,e,f,g,h,m,n,o,p,q,r,s,t;for(k(a),c=function(a,b){var c;return c=l.colourMap(a[b+2],i[j]),new THREE.Color(c.r,c.g,c.b)},this._legendState=[],this._totalHits=0,e=0,h=a.length;h>e;e++){for(r=a[e],t=new THREE.Geometry,s=0,q=r[1],d=f=0,m=q.length;m>f;d=f+=3)o=q[d],g=r[1][d],n=r[1][d+1],b=c(r[1],d),s+=r[1][d+2],this.addPoint(g,n,0,b,t);this._legendState.push({name:r[0],numHits:s}),this._totalHits+=s,p=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:16777215,vertexColors:THREE.FaceColors,morphTargets:!1,transparent:!0,opacity:1})),this.seriesGeos[r[0]]=p,this.scene.add(p)}},a.prototype.addPoint=function(a,b,c,d,e){var f,g,h,i,j,k;for(i=(90-a)*Math.PI/180,k=(180-b)*Math.PI/180,this.point.position.x=150*Math.sin(i)*Math.cos(k),this.point.position.y=150*Math.cos(i),this.point.position.z=150*Math.sin(i)*Math.sin(k),this.point.lookAt(this.mesh.position),this.point.scale.z=Math.max(c,.1),this.point.updateMatrix(),j=this.point.geometry.faces,g=0,h=j.length;h>g;g++)f=j[g],f.color=d;return e.mergeMesh(this.point)},a.prototype.initLegend=function(){return React.render(React.createElement(f,{series:this._legendState,totalHits:this._totalHits,toggleHandler:this.onLegendToggle}),document.getElementById("series-selector"))},a.prototype.onMouseDown=function(a){return a.preventDefault(),this.k=0,this.f=!0,this.inMouseDrag=!0,this.target.y=this.rotation.y,this.mouseOnDown.x=-a.clientX,this.mouseOnDown.y=a.clientY,this.targetOnDown.x=this.target.x,this.targetOnDown.y=this.target.y,this.container.style.cursor="move"},a.prototype.onMouseMove=function(a){var b;if(this.inMouseDrag)return this.mouse.x=-a.clientX,this.mouse.y=a.clientY,b=this.distance/1e3,this.target.x=this.targetOnDown.x+.005*(this.mouse.x-this.mouseOnDown.x)*b,this.target.y=this.targetOnDown.y+.005*(this.mouse.y-this.mouseOnDown.y)*b,this.target.y=this.target.y>d?d:this.target.y,this.target.y=this.target.y<-d?-d:this.target.y},a.prototype.onMouseUp=function(){return this.inMouseDrag?(this.k=e,this.f=!1,this.inMouseDrag=!1,this.container.style.cursor="auto"):void 0},a.prototype.onMouseOut=function(){return this.inMouseDrag?(this.k=e,this.f=!1,this.inMouseDrag=!1):void 0},a.prototype.onMouseWheel=function(a){var b;return a.preventDefault(),this.overRenderer&&(b=0,a.wheelDelta?b=.3*a.wheelDelta:a.detail&&(b=10*-a.detail),this.zoom(b)),!1},a.prototype.onLegendToggle=function(a,b){var c,d,e,f;return e=0,c=1,b||(e=1,c=0),d=this.seriesGeos[a].material,f=new h.Tween({x:e}).to({x:c},500),f.onUpdate(function(){return d.opacity=this.x}),f.start()},a.prototype.zoom=function(a){return this.distanceTarget-=a,this.distanceTarget=this.distanceTarget>1100?1100:this.distanceTarget,this.distanceTarget=this.distanceTarget<350?350:this.distanceTarget},a.prototype.render=function(){return this.zoom(0),this.target.x-=this.k,this.rotation.x+=.2*(this.target.x-this.rotation.x),this.f?this.rotation.y+=.2*(this.target.y-this.rotation.y):(this.target.y=Math.PI/5,this.rotation.y+=.02*(this.target.y-this.rotation.y)),this.distance+=.3*(this.distanceTarget-this.distance),this.camera.position.x=this.distance*Math.sin(this.rotation.x)*Math.cos(this.rotation.y),this.camera.position.y=this.distance*Math.sin(this.rotation.y),this.camera.position.z=this.distance*Math.cos(this.rotation.x)*Math.cos(this.rotation.y),this.camera.lookAt(this.mesh.position),this.renderer.render(this.scene,this.camera),h.update()},a}(),k=function(a){var b,c,d,e,f;for(b=0,c=0,d=a.length;d>c;c++)f=a[c],e=Math.max.apply(Math,f[1]),i[f[0]]=e,e>b&&(b=e,j=f[0])}},{"./components/series-selector":2,"./utils":5,"tween.js":6}],4:[function(a){var b,c,d;b=a("./globe"),d=null,$(function(){return Detector.webgl?$.ajax({url:"http://cymon.io/api/publicajax/nexus/globe/?categories=1",dataType:"json",error:function(a,b){return alert("Could not load data. Reason: "+b)},success:function(a){var e;return e=document.getElementById("globe"),THREE.ImageUtils.loadTexture("../img/map2.jpg",void 0,function(f){return d=b.createGlobe(e,f),d.addData(a.data),d.initLegend(),c()})}}):Detector.addGetWebGLMessage()}),c=function(){return requestAnimationFrame(c),d.render()}},{"./globe":3}],5:[function(a,b){var c;c=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]],b.exports={colourMap:function(a,b){var d,e,f,g,h,i;return a/=b,e=0,0>=a?(g=0,h=0):a>=1?(g=c.length-1,h=c.length-1):(a*=c.length-1,g=Math.floor(a),h=g+1,e=a-g),i=(c[h][0]-c[g][0])*e+c[g][0],f=(c[h][1]-c[g][1])*e+c[g][1],d=(c[h][2]-c[g][2])*e+c[g][2],{r:Math.floor(255*i),g:Math.floor(255*f),b:Math.floor(255*d)}}}},{}],6:[function(a,b){void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var c=c||function(){var a=[];return{REVISION:"14",getAll:function(){return a},removeAll:function(){a=[]},add:function(b){a.push(b)},remove:function(b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},update:function(b){if(0===a.length)return!1;var c=0;for(b=void 0!==b?b:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();c<a.length;)a[c].update(b)?c++:a.splice(c,1);return!0}}}();c.Tween=function(a){var b=a,d={},e={},f={},g=1e3,h=0,i=!1,j=!1,k=!1,l=0,m=null,n=c.Easing.Linear.None,o=c.Interpolation.Linear,p=[],q=null,r=!1,s=null,t=null,u=null;for(var v in a)d[v]=parseFloat(a[v],10);this.to=function(a,b){return void 0!==b&&(g=b),e=a,this},this.start=function(a){c.add(this),j=!0,r=!1,m=void 0!==a?a:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),m+=l;for(var g in e){if(e[g]instanceof Array){if(0===e[g].length)continue;e[g]=[b[g]].concat(e[g])}d[g]=b[g],d[g]instanceof Array==!1&&(d[g]*=1),f[g]=d[g]||0}return this},this.stop=function(){return j?(c.remove(this),j=!1,null!==u&&u.call(b),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var a=0,b=p.length;b>a;a++)p[a].stop()},this.delay=function(a){return l=a,this},this.repeat=function(a){return h=a,this},this.yoyo=function(a){return i=a,this},this.easing=function(a){return n=a,this},this.interpolation=function(a){return o=a,this},this.chain=function(){return p=arguments,this},this.onStart=function(a){return q=a,this},this.onUpdate=function(a){return s=a,this},this.onComplete=function(a){return t=a,this},this.onStop=function(a){return u=a,this},this.update=function(a){var c;if(m>a)return!0;r===!1&&(null!==q&&q.call(b),r=!0);var j=(a-m)/g;j=j>1?1:j;var u=n(j);for(c in e){var v=d[c]||0,w=e[c];w instanceof Array?b[c]=o(w,u):("string"==typeof w&&(w=v+parseFloat(w,10)),"number"==typeof w&&(b[c]=v+(w-v)*u))}if(null!==s&&s.call(b,u),1==j){if(h>0){isFinite(h)&&h--;for(c in f){if("string"==typeof e[c]&&(f[c]=f[c]+parseFloat(e[c],10)),i){var x=f[c];f[c]=e[c],e[c]=x}d[c]=f[c]}return i&&(k=!k),m=a+l,!0}null!==t&&t.call(b);for(var y=0,z=p.length;z>y;y++)p[y].start(a);return!1}return!0}},c.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b,c=.1,d=.4;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI),-(c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/d)))},Out:function(a){var b,c=.1,d=.4;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI),c*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/d)+1)},InOut:function(a){var b,c=.1,d=.4;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI),(a*=2)<1?-.5*c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/d):c*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/d)*.5+1)}},Back:{In:function(a){var b=1.70158;return a*a*((b+1)*a-b)},Out:function(a){var b=1.70158;return--a*a*((b+1)*a+b)+1},InOut:function(a){var b=2.5949095;return(a*=2)<1?.5*a*a*((b+1)*a-b):.5*((a-=2)*a*((b+1)*a+b)+2)}},Bounce:{In:function(a){return 1-c.Easing.Bounce.Out(1-a)},Out:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*c.Easing.Bounce.In(2*a):.5*c.Easing.Bounce.Out(2*a-1)+.5}}},c.Interpolation={Linear:function(a,b){var d=a.length-1,e=d*b,f=Math.floor(e),g=c.Interpolation.Utils.Linear;return 0>b?g(a[0],a[1],e):b>1?g(a[d],a[d-1],d-e):g(a[f],a[f+1>d?d:f+1],e-f)},Bezier:function(a,b){var d,e=0,f=a.length-1,g=Math.pow,h=c.Interpolation.Utils.Bernstein;for(d=0;f>=d;d++)e+=g(1-b,f-d)*g(b,d)*a[d]*h(f,d);return e},CatmullRom:function(a,b){var d=a.length-1,e=d*b,f=Math.floor(e),g=c.Interpolation.Utils.CatmullRom;return a[0]===a[d]?(0>b&&(f=Math.floor(e=d*(1+b))),g(a[(f-1+d)%d],a[f],a[(f+1)%d],a[(f+2)%d],e-f)):0>b?a[0]-(g(a[0],a[0],a[1],a[1],-e)-a[0]):b>1?a[d]-(g(a[d],a[d],a[d-1],a[d-1],e-d)-a[d]):g(a[f?f-1:0],a[f],a[f+1>d?d:f+1],a[f+2>d?d:f+2],e-f)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var d=c.Interpolation.Utils.Factorial;return d(a)/d(b)/d(a-b)},Factorial:function(){var a=[1];return function(b){var c,d=1;if(a[b])return a[b];for(c=b;c>1;c--)d*=c;return a[b]=d}}(),CatmullRom:function(a,b,c,d,e){var f=.5*(c-a),g=.5*(d-b),h=e*e,i=e*h;return(2*b-2*c+f+g)*i+(-3*b+3*c-2*f-g)*h+f*e+b}}},b.exports=c},{}]},{},[1,2,3,4,5]);